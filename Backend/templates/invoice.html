<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>Recibo {{ receipt_number }}</title>
    <style>
      @page {
        size: A4;
        margin: 0;
      }
      body {
        font-family: "Arial", sans-serif;
        font-size: 12px;
        color: #333;
        margin: 0;
        line-height: 1.4;
        background: white;
      }
      .receipt-wrapper {
        width: 21cm;
        height: 14.85cm;
        padding: 2cm;
        box-sizing: border-box;
        border-bottom: 2px dashed #ccc;
        position: relative;
      }

      /* Header con logo y título */
      .header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 2cm;
        padding-bottom: 1cm;
        border-bottom: 2px solid #333;
      }

      .company-section {
        flex: 1;
        display: flex;
        align-items: flex-start;
        gap: 15px;
      }

      .company-logo {
        flex-shrink: 0;
      }

      .company-details {
        flex: 1;
      }

      .company-info {
        line-height: 1.5;
      }

      .company-info .company-name {
        font-size: 18px;
        font-weight: bold;
        color: #333;
        margin-bottom: 5px;
      }

      .company-info p {
        margin: 3px 0;
        font-size: 11px;
        color: #666;
      }

      .logo {
        width: 100px;
        height: auto;
        margin-bottom: 15px;
        margin-right: 20px;
      }

      .receipt-title {
        font-size: 24px;
        font-weight: bold;
        color: #333;
        text-align: right;
        margin-top: 20px;
      }

      /* Sección de detalles cliente y recibo */
      .details-section {
        display: flex;
        justify-content: space-between;
        margin-bottom: 2cm;
      }

      .client-info {
        flex: 1;
        margin-right: 3cm;
      }

      .client-info h2 {
        font-size: 12px;
        font-weight: bold;
        color: #333;
        margin: 0 0 10px 0;
        text-transform: uppercase;
      }

      .client-info p {
        margin: 4px 0;
        font-size: 11px;
        line-height: 1.4;
      }

      .receipt-info {
        text-align: right;
        min-width: 200px;
      }

      .receipt-info p {
        margin: 4px 0;
        font-size: 11px;
      }

      .receipt-info strong {
        color: #333;
      }

      /* Tabla de items */
      .items-table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 1.5cm;
      }

      .items-table th {
        background-color: #f8f9fa;
        border: 1px solid #dee2e6;
        padding: 12px 8px;
        text-align: left;
        font-size: 11px;
        font-weight: bold;
        text-transform: uppercase;
        color: #495057;
      }

      .items-table td {
        border: 1px solid #dee2e6;
        padding: 12px 8px;
        font-size: 11px;
      }

      .items-table .text-right {
        text-align: right;
      }

      .items-table .text-center {
        text-align: center;
      }

      /* Sección de totales */
      .totals-section {
        margin-top: 1cm;
        display: flex;
        justify-content: flex-end;
      }

      .totals-table {
        width: 300px;
        border-collapse: collapse;
      }

      .totals-table td {
        padding: 8px;
        font-size: 11px;
        border-bottom: 1px solid #eee;
      }

      .totals-table .total-row {
        font-weight: bold;
        font-size: 14px;
        border-top: 2px solid #333;
        border-bottom: 2px solid #333;
      }

      .totals-table .text-right {
        text-align: right;
      }

      /* Footer */
      .footer {
        position: absolute;
        bottom: 1.5cm;
        left: 2cm;
        right: 2cm;
        text-align: center;
        font-size: 10px;
        color: #666;
        border-top: 1px solid #eee;
        padding-top: 15px;
      }

      .footer p {
        margin: 3px 0;
      }

      /* Método de pago */
      .payment-method {
        margin-top: 1cm;
        font-size: 11px;
      }

      .payment-method strong {
        color: #333;
      }
    </style>
  </head>
  <body>
    <div class="receipt-wrapper">
      <!-- Header -->
      <div class="header">
        <div class="company-section">
          <div class="company-logo">
            {% if logo_path %}
            <img
              src="{{ logo_path }}"
              alt="Logo NetSys Solutions"
              class="logo"
            />
            {% endif %}
          </div>
          <div class="company-details">
            <div class="company-name">{{ company_name }}</div>
            <p>{{ company_address }}</p>
            <p>{{ company_contact }}</p>
          </div>
        </div>
        <div class="receipt-title">RECIBO DE PAGO</div>
      </div>

      <!-- Detalles del cliente y recibo -->
      <div class="details-section">
        <div class="client-info">
          <h2>CLIENTE:</h2>
          <p><strong>{{ client_name }}</strong></p>
          <p>{{ client_address }}</p>
          <p>
            {% if client_barrio and client_barrio != 'None' %}{{ client_barrio
            }}, {% endif %}{{ client_city }}
          </p>
          <p>Email: {{ client_email }}</p>
        </div>
        <div class="receipt-info">
          <p><strong>RECIBO N°:</strong></p>
          <p>{{ receipt_number }}</p>
          <p><strong>FECHA DE PAGO:</strong></p>
          <p>{{ payment_date }}</p>
        </div>
      </div>

      <!-- Tabla de items -->
      <table class="items-table">
        <thead>
          <tr>
            <th>Descripción</th>
            <th class="text-center">Cantidad</th>
            <th class="text-right">Precio Unit.</th>
            <th class="text-right">Total</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>{{ item_description }} (x1)</td>
            <td class="text-center">1</td>
            <td class="text-right">{{ "%.2f"|format(base_amount) }} €</td>
            <td class="text-right">{{ "%.2f"|format(base_amount) }} €</td>
          </tr>
          {% if late_fee > 0 %}
          <tr>
            <td>Recargo por mora (x1)</td>
            <td class="text-center">1</td>
            <td class="text-right">{{ "%.2f"|format(late_fee) }} €</td>
            <td class="text-right">{{ "%.2f"|format(late_fee) }} €</td>
          </tr>
          {% endif %}
        </tbody>
      </table>

      <!-- Método de pago y total -->
      <div class="payment-method">
        <p><strong>MÉTODO DE PAGO:</strong> N/A (Factura)</p>
      </div>

      <div class="totals-section">
        <table class="totals-table">
          <tr class="total-row">
            <td><strong>TOTAL PAGADO:</strong></td>
            <td class="text-right">
              <strong>{{ "%.2f"|format(total_paid) }} €</strong>
            </td>
          </tr>
        </table>
      </div>

      <!-- Footer -->
      <div class="footer">
        <p><strong>Gracias por su pago.</strong></p>
        <p>Notas: Factura {{ receipt_number }}. Vence el {{ due_date }}.</p>
      </div>
    </div>
  </body>
</html>
